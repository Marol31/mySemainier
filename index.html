<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>semainier</title>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Cookie">
    <link rel="stylesheet" href="assets/fonts/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="assets/css/Pretty-Header.css">
    <link rel="stylesheet" href="assets/css/Pretty-Footer.css">
    <link href="https://file.myfontastic.com/n6vo44Re5QaWo8oCKShBs7/icons.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/2.0.16/jspdf.plugin.autotable.js"></script>
    <!-- <script type="txt/javascript" src="assets/js/jquery.min.js"></script>
    <script type="text/javascript" scr="assets/js/jspdf.js"></script> -->
    <script type="text/javascript">
        $(document).ready(function() {
                  //on créé un tableau pour chaque jour de la semaine
                   tab_lundi = [];
                   tab_mardi = [];
                   tab_mercredi = [];
                   tab_jeudi = [];
                   tab_vendredi = [];
                   tab_samedi = [];
                   tab_dimanche = [];

                   //affichage par defaut de lundi
                   var defautLundi = "<p class='lundi'>exemple:</p><li class='lundi'>Faire du sport</li><li class='lundi'>Faire les courses</li>";
                   //insertion valeur par defautLundi
                   $(defautLundi).css({color:'#C0C0C0',fontSize:'17px'}).appendTo($("ul[id='lundi'"));
                   //enregistre la valeur html de lundi dans une variable
                    affichageLundi = $("ul[id='lundi']").html();
                   //affichage par defaut de Mardi
                   var defautMardi = "<p class='mardi'>exemple:</p><li class='mardi'>9h00 : RDV Médical</li><li class='mardi'>11h30 : Déjeûner en ville</li><li class='mardi'>Faire les courses</li>";
                   //insertion valeur par defautMardi
                   $(defautMardi).css('color', '#C0C0C0').appendTo($("ul[id='mardi'"));
                   //enregistre la valeur html de mardi dans une variable
                    affichageMardi = $("ul[id='mardi']").html();
                   //affichage par defaut de Mercredi
                   var defautMercredi = "<p class='mercredi'>exemple:</p><li class='mercredi'>9h00 : RDV Médical</li><li class='mercredi'>Diner chez Bernard</li>";
                   //insertion valeur par defautMercredi
                   $(defautMercredi).css('color', '#C0C0C0').appendTo($("ul[id='mercredi'"));
                   //enregistre la valeur html de mercredi dans une variable
                    affichageMercredi = $("ul[id='mercredi']").html();
                   //affichage par defaut de Jeudi
                   var defautJeudi = "<p class='jeudi'>exemple:</p><li class='jeudi'>9h00 : RDV Médical</li><li class='jeudi'>Anniversaire Sacha</li><li class='jeudi'>14h00 : RDV Dentiste</li>";
                   //insertion valeur par defautJeudi
                   $(defautJeudi).css('color', '#C0C0C0').appendTo($("ul[id='jeudi'"));
                   //enregistre la valeur html de jeudi dans une variable
                    affichageJeudi = $("ul[id='jeudi']").html();
                   //affichage par defaut de Vendredi
                   var defautVendredi = "<p class='vendredi'>exemple:</p><li class='vendredi'>Aller à la piscine</li><li class='vendredi'>Pique-nique au parc</li>";
                   //insertion valeur par defautVendredi
                   $(defautVendredi).css('color', '#C0C0C0').appendTo($("ul[id='vendredi'"));
                   //enregistre la valeur html de jeudi dans une variable
                    affichageVendredi = $("ul[id='vendredi']").html();

                   $("#button").click(function(){
                  //on enleve le comportement natif du bouton
                  event.preventDefault();

                  //on récupère le jour choisi dans le select
                  var jour = $("#jour option:selected").val();
                  //on récupère ce que l'utilisateur a tapé dans le input
                  var tache = $("#tache").val();

                  //DEBUT DE TEST INPUT
                  if ( tache == ''){
                    alert("vous devez d'abords saisir une tâche ou un rappel.");
                  }else{
                          //on repupere la valeur se trouvant dans le jour sélectionné
                          var affichageDefautJour = $("ul[id="+jour+"]").html();

                          //on teste la valeur trouvée
                          //si la valeur par defaut est dans le ul,
                          if ((affichageDefautJour==affichageLundi) || (affichageDefautJour==affichageMardi) || (affichageDefautJour==affichageMercredi) || (affichageDefautJour==affichageJeudi) || (affichageDefautJour==affichageVendredi) ){
                            // on enlève la valeur par défaut
                            $("li[class='"+jour+"'],p[class='"+jour+"']").remove();

                            //puis on injecte le texte tapé dans un li au jour choisi dans le tableau
                            $("<li>"+tache+"</li>").appendTo($("ul[id="+jour+"]"));
                          }else{
                            // on injecte le texte tapé dans un li au jour choisi dans le tableau
                            $("<li>"+tache+"</li>").appendTo($("ul[id="+jour+"]"));
                          }
                  }
                  // FIN DE TEST INPUT



                  //on stocke la tache dans le tableau du jour concerné
                  if(jour==="lundi"){

                      tab_lundi.push("<li>"+tache+"</li>");
                  };
                  if(jour==="mardi"){
                    tab_mardi.push(tache);
                  };
                  if(jour==="mercredi"){
                    tab_mercredi.push(tache);
                  };
                  if(jour==="jeudi"){
                    tab_jeudi.push(tache);
                  };
                  if(jour==="vendredi"){
                    tab_vendredi.push(tache);
                  };
                  if(jour==="samedi"){
                    tab_samedi.push(tache);
                  };
                  if(jour==="dimanche"){
                    tab_dimanche.push(tache);
                  };

                  // puis on vide le input
                  $("#tache").val("");

                });

                $("#pdf").click(function(){
                  event.preventDefault();

                   debut = $("#date_debut").val();
                   fin = $("#date_fin").val();

                     // on enlève la valeur par défaut
                     $("li[class='lundi'],p[class='lundi'],li[class='mardi'],p[class='mardi'],li[class='mercredi'],p[class='mercredi'],li[class='jeudi'],p[class='jeudi'],li[class='vendredi'],p[class='vendredi']").remove();

                  function generate() {

                  var doc = new jsPDF('l', 'pt');

                  var res = doc.autoTableHtmlToJson(document.getElementById("table"));
                  console.log(res);
                  doc.autoTable(res.columns, res.data, {margin: {top: 80}});

                  var header = function(data) {
                  doc.setFontSize(18);
                  doc.setTextColor(40);
                  doc.setFontStyle('normal');
                  //doc.addImage(headerImgData, 'JPEG', data.settings.margin.left, 20, 50, 50);
                  doc.text("Semaine du "+debut+" au "+fin, data.settings.margin.left, 50);
                  };

                  var options = {
                  beforePageContent: header,
                  margin: {
                  top: 120
                  },
                  startY: doc.autoTableEndPosY() + 20
                  };

                //  doc.autoTable(res.columns, res.data, options);

                  doc.save("table.pdf");

                }

                  //on teste si les dates ont été remplies
                  if ((debut=='')&&(fin=='')){
                    alert('Vous n\'avez pas  renseigner de dates ?');

                  }else{

                  generate();

                  }




                  //création du pdf
                  // var doc = new jsPDF('l', 'pt');
                  // var header = function(data) {
                  // doc.setFontSize(18);
                  // doc.setTextColor(40);
                  // doc.setFontStyle('normal');
                  // doc.text("Semaine du "+debut+" au "+fin, data.settings.margin.left, 50);
                  // };
                  // var elem = document.getElementById("table");
                  // var res = doc.autoTableHtmlToJson(elem);
                  // doc.autoTable(res.columns, res.data);
                  // doc.save("mySemainier.pdf");

                });

        });
    </script>
</head>

<body>
    <nav class="navbar navbar-default custom-header">
        <div class="container-fluid">
            <div class="navbar-header"><a class="navbar-brand navbar-link" href="#">My<span>Semainier </span> </a>
                <button class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button>
            </div>

        </div>
    </nav>
    <h1 class="text-center">Ma semaine en un clic</h1>
    <blockquote>
        <p class="text-center">Remplissez vos rendez-vous, vos taches ou tout ce dont vous devez vous rappeller pour votre semaine et imprimez-le. </p>
        <footer>En quelques clics, planifiez votre emploi du temps ou celui de vos proches et mettez-le en vue pour organiser au plus juste votre semaine !</footer>
    </blockquote>
    <div class="row">
    <div class="col-lg-12 col-md-12">
        <form class="bootstrap-form-with-validation">
            <h2 class="text-center">Remplissez votre semaine:</h2>
            <label for="titre">Rentrez la semaine concernée :</label>
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12">
                    <div class="form-group">
                        <div class="row">
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <label for="date_debut" class="control-label">Semaine du :</label>
                                <input type="date" name="date_debut" id="date_debut" class="form-control" />
                            </div>
                            <div class="col-lg-6 col-md-6 col-sm-6">
                                <label for="date_fin" class="control-label">Au :</label>
                                <input type="date" name="date_fin" id="date_fin" class="form-control" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <label for="jour">Choisissez le jour</label>
            <select id="jour" required class="form-control" name="jour">
                <optgroup label="Choisissez le jour">
                    <option value="lundi" selected>Lundi</option>
                    <option value="mardi">Mardi</option>
                    <option value="mercredi">Mercredi</option>
                    <option value="jeudi">Jeudi</option>
                    <option value="vendredi">Vendredi</option>
                    <option value="samedi">Samedi</option>
                    <option value="dimanche">Dimanche</option>
                </optgroup>
            </select>
            <!-- <label>Précisez un niveau d&#39;importance</label>
            <select class="form-control">
                <optgroup label="Niveau d&#39;importance">
                    <option value="pas" selected>peu important</option>
                    <option value="normal">normal</option>
                    <option value="important">Impératif</option>
                </optgroup>
            </select> -->
            <div class="form-group"></div>
            <label>Indiquez votre rappel, votre tache ou votre RDV</label>
            <div class="form-group has-warning" id="monForm">
                <textarea required maxlength="150" class="form-control input-sm" id="tache"></textarea>
                <button class="btn btn-primary" id="button" type="submit" >Ajouter</button>
            </div>
        </form>
    </div>
</div>
<div class="row">
  <div id="test" class="col-lg-10 col-lg-offset-1" style="background-color:#C0C0C0;height:100px;"></div>
</div>
<div class="row">
<div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-sm-10 col-sm-offset-1 col-sm-push-0 col-xs-10 col-xs-offset-1 col-xs-push-0">
    <h3>Votre semainier :</h3>
    <div class="responsive-table-line" style="margin:0px auto;">
        <table class="table table-bordered table-condensed" id="table">
          <thead>
<tr>
<th class="info">Lundi</th>
<th class="info">Mardi</th>
<th class="info">Mercredi</th>
<th class="info">Jeudi</th>
<th class="info">Vendredi</th>
<th class="info">Samedi</th>
<th class="info">Dimanche</th>
</tr>
</thead>
<tbody>
<tr>
<td data-title="Lundi" id="listelundi"><ul id="lundi"></ul></td>
<td data-title="Mardi"><ul id="mardi"></ul></td>
<td data-title="Mercredi"><ul id="mercredi"></ul></td>
<td data-title="Jeudi"><ul id="jeudi"></td>
<td data-title="Vendredi"><ul id="vendredi"></ul></td>
<td data-title="Samedi"><ul id="samedi"></ul></td>
<td data-title="Dimanche"><ul id="dimanche"></ul></td>
</tr>

</tbody>
        </table>
    </div>
</div>
<div class="row">
    <div class="col-lg-2 col-lg-offset-5 col-md-2 col-md-offset-5 col-sm-2 col-sm-offset-5 col-xs-6 col-xs-offset-3">
        <form>
            <button class="btn btn-warning btn-lg" id="pdf" type="submit">Générer PDF</button>
        </form>
    </div>
</div>
</div>
    <footer>
        <div class="row">
            <div class="col-md-4 col-sm-6 footer-navigation">
                <h3><a href="#">My<span>Semainier </span></a></h3>
                <p class="company-name">Marol © 2016 </p>
            </div>
            <div class="col-md-4 col-sm-6 footer-contacts">
                <div></div>
                <div><i class="fa fa-envelope footer-contacts-icon"></i>
                    <p> <a href="#" target="_blank">contact@marylin-roldan.com</a></p>
                </div>
            </div>
            <div class="clearfix visible-sm-block"></div>
            <div class="col-md-4 footer-about">
      <div class="social-links social-icons"><a href="#"><i class="fa fa-facebook"></i></a><a href="#"><i class="socicon-viadeo"></i></a><a href="#"><i class="fa fa-linkedin"></i></a><a href="#"><i class="fa fa-github"></i></a></div>
  </div>
        </div>
    </footer>
    <script src="assets/js/jquery.min.js"></script>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
</body>

</html>
